# Function-based API

## 定位
实现逻辑组合和复用，举例说明：

> 小明要蒸馒头和包子，但是二者都需要和面。那么在程序中，和面就是二者需要复用的逻辑。

``` javascript
function huomian(){
    console.log( "It is huomianing" )
}

class Baozi{
    constructor(){
        huomian();
        return {
            name: 'baozi'
        }
    }
}
class Mantou{
    constructor(){
        huomian()
        return {
            name: 'mantou'
        }
    }
}

// 复用的逻辑被写成了一个函数，供其他人使用
```
转换成vue源码，分别把包子和馒头看做一个组件。

``` javascript
const mixin = {
    beforeCreated(){
        console.log('It is huomianing')
    }
}
// baozi
export default {
    mixins: [mixin],
    mounted(){
        console.log('return baozi')
    }
}

// mantou
export default {
    mixins: [mixin],
    mounted(){
        console.log('return mantou')
    }
}

// beforeCreated 是复用的地方，并且通过mixin的方式实现
```

`mixin`是vue 2.x推荐的逻辑复用方案，而在React中，此场景下一般通过高阶组件（High-order Component）实现。

如果使用最新的Function-based Api写法呢？
``` javascript
function huomian(){
    console.log( "It is huomianing" )
}
// baozi
export default {
    setup(){
        onBeforeCreated(huomian) 
    },
    mounted(){
        console.log('return baozi')
    }
}

// mantou
export default {
    setup(){
        onBeforeCreated(huomian) 
    },
    mounted(){
        console.log('return mantou')
    }
}

// setup是实现逻辑复用的地方
```

这种写法初看和mixin区别不明显，但需要注意的一点是，在Function-based的写法中， setup中复用的逻辑是可以自由组合，如果蒸包子这件事的beforeCreated中再加上调馅这件事，可以再写一个调馅的方法`tiaoxian`，在setup中调用(这就叫逻辑组合)。这样就避免了mixin的复杂性（否则需要写两个mixin）


## 出现的原由
在此之前已经有现有的方案用于解决逻辑复用，主要有mixin, HOC, Slot。但或多或少存在如下一些问题：

1. 数据来源不清晰——mixin, HOC；
2. 命名空间冲突——mixin, HOC;
3. 性能消耗——Slot；
