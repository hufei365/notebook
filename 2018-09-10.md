## 闭包（Closure）

闭包是计算机科学中最难以被确定描述的概念了。很多人的理解就是归化成一句话：**闭包就是能够读取其他函数内部变量的函数**。

稍微解释一下， 函数内部定义的变量，通常情况下都是局部变量。按照通产意义上的理解，局部变量是无法在在函数外部被访问到的。如果非要访问内部变量，通常有如下这种做法：

``` javascript
var f = function(){
    var v = 1;

    return function(){
        console.log(v++);
    }
}

var a = f();
a(); // 1
a(); // 2
```
我们通过函数a可以访问到函数f内部定义的变量v，这种情况下a就是一个闭包。理论上在执行完`var a = f();`后， 函数f里面的变量应该得到释放（JS的垃圾回收机制）。但是，因为f返回的是一个函数，而这个函数内部引用了f中定义的变量v。在外部，被返回的函数有被使用，所以不能释放其引用的变量。也因此，我们可以访问到函数f内部定义的变量v。

很多人对闭包理解可能是上面这个样子的，但是维基百科上给出的解释是下面这个样子：

> 在计算机科学中，闭包（Closure）是词法闭包（Lexical Closure）的简称，是引用了自由变量的函数。这个被引用的自由变量将和这个函数一同存在，即使已经离开了创造它的环境也不例外。所以，有另一种说法认为闭包是由函数和与其相关的引用环境组合而成的实体。
> 
> Peter J. Landin 在1964年将术语闭包定义为一种包含环境成分和控制成分的实体。

这是数学逻辑上的一种解释，如果非要从概念上解释闭包，这个解释感觉更贴切一些。



### 闭包有什么作用
- 用来模拟私有变量，利用作用域机制限制外部程序对函数内部变量的访问；
- 长期保存某个变量，比如可以用来保存状态等；

### 闭包有什么不好
- 因为闭包会使得函数中的变量都被保存在内存中，就会导致内存一致无法释放。最终内存占用越来越大，所以不能滥用闭包，否则会造成网页的性能问题，在IE中可能导致内存泄露。解决方法是，在退出函数之前，将不使用的局部变量全部删除。

- 闭包会在父函数外部，改变父函数内部变量的值。所以，如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便改变父函数内部变量的值。


[how-do-javascript-closures-work](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)

[什么是闭包，我的理解](http://www.cnblogs.com/xiaotie/archive/2011/08/03/2126145.html)